<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Models module &#8212; RadIO 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Preprocessing module" href="lung_cancer.preprocessing.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lung_cancer.preprocessing.html" title="Preprocessing module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">RadIO 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="models-module">
<h1>Models module<a class="headerlink" href="#models-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lung_cancer.models.base_model">
<span id="lung-cancer-models-base-model-module"></span><h2>lung_cancer.models.base_model module<a class="headerlink" href="#module-lung_cancer.models.base_model" title="Permalink to this headline">¶</a></h2>
<p>Contains base class for both keras and tensorflow model.</p>
<dl class="class">
<dt id="lung_cancer.models.base_model.BaseModel">
<em class="property">class </em><code class="descclassname">lung_cancer.models.base_model.</code><code class="descname">BaseModel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base model class for both keras and tensorflow models.</p>
<dl class="method">
<dt id="lung_cancer.models.base_model.BaseModel.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel.compile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Complile model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.base_model.BaseModel.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.base_model.BaseModel.predict_on_batch">
<code class="descname">predict_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel.predict_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel.predict_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict on batch.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.base_model.BaseModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.base_model.BaseModel.train_on_batch">
<code class="descname">train_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>y_true</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/base_model.html#BaseModel.train_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.base_model.BaseModel.train_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train model on batch.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.dense_net">
<span id="lung-cancer-models-dense-net-module"></span><h2>lung_cancer.models.dense_net module<a class="headerlink" href="#module-lung_cancer.models.dense_net" title="Permalink to this headline">¶</a></h2>
<p>Contains DenseNet model class.</p>
<dl class="class">
<dt id="lung_cancer.models.dense_net.DenseNet">
<em class="property">class </em><code class="descclassname">lung_cancer.models.dense_net.</code><code class="descname">DenseNet</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.tf_model.TFModel" title="lung_cancer.models.tf_model.TFModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.tf_model.TFModel</span></code></a></p>
<p>This class implements 3D DenseNet architecture via tensorflow.</p>
<dl class="staticmethod">
<dt id="lung_cancer.models.dense_net.DenseNet.average_pool3d">
<em class="property">static </em><code class="descname">average_pool3d</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>pool_size</em>, <em>strides</em>, <em>name</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.average_pool3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.average_pool3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply average pooling 3D operation to input_tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- pool_size: tuple(int, int, int), size of pooling kernel along 3 dimensions;
- strides: tuple(int, int, int), size of strides along 3 dimensions;
- name: str, name of layer that will be used as an argument of tf.variable_scope;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.dense_net.DenseNet.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build densenet model implemented via tensorflow.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.dense_net.DenseNet.dense_block">
<code class="descname">dense_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>block_size</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.dense_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.dense_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Dense block which is used as a build block of densenet model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.dense_net.DenseNet.dropout">
<code class="descname">dropout</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>rate=0.3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Add dropout layer with given dropout rate to the input tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- rate: float, dropout rate;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lung_cancer.models.dense_net.DenseNet.global_average_pool3d">
<em class="property">static </em><code class="descname">global_average_pool3d</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.global_average_pool3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.global_average_pool3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply global average pooling 3D operation to input tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- name: str, name of layer that will be used as an argument of tf.variable_scope;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lung_cancer.models.dense_net.DenseNet.max_pool3d">
<em class="property">static </em><code class="descname">max_pool3d</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>pool_size</em>, <em>strides</em>, <em>name</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.max_pool3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.max_pool3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply max pooling 3D operation to input_tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input_tensor;
- pool_size: tuple(int, int, int), size of pooling kernel along 3 dimensions;
- strides: tuple(int, int, int), size of strides along 3 dimensions;
- name: str, name of layer that will be used as an argument of tf.variable_scope;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.dense_net.DenseNet.transition_layer">
<code class="descname">transition_layer</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/dense_net.html#DenseNet.transition_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.dense_net.DenseNet.transition_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Transition layer which is used as a dimension reduction block in densenset model.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- filters: int, number of filters in output tensor;
- name: str, name of the layer that will be used as an argument of tf.variable_scope;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.keras_model">
<span id="lung-cancer-models-keras-model-module"></span><h2>lung_cancer.models.keras_model module<a class="headerlink" href="#module-lung_cancer.models.keras_model" title="Permalink to this headline">¶</a></h2>
<p>Contains base class for all keras models.</p>
<dl class="class">
<dt id="lung_cancer.models.keras_model.KerasModel">
<em class="property">class </em><code class="descclassname">lung_cancer.models.keras_model.</code><code class="descname">KerasModel</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.base_model.BaseModel" title="lung_cancer.models.base_model.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.base_model.BaseModel</span></code></a></p>
<p>Base class for all keras models.</p>
<p>Contains load, dump and compile methods which are shared between all
keras models;
Also implements train_on_batch and predict_on_batch methods;</p>
<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize inner keras model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>optimizer</em>, <em>loss</em>, <em>metrics=None</em>, <em>loss_weights=None</em>, <em>sample_weight_mode=None</em>, <em>weighted_metrics=None</em>, <em>target_tensors=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="docutils">
<dt># Arguments</dt>
<dd><dl class="first last docutils">
<dt>optimizer: String (name of optimizer) or optimizer object.</dt>
<dd>See [optimizers](/optimizers).</dd>
<dt>loss: String (name of objective function) or objective function.</dt>
<dd>See [losses](/losses).
If the model has multiple outputs, you can use a different loss
on each output by passing a dictionary or a list of losses.
The loss value that will be minimized by the model
will then be the sum of all individual losses.</dd>
<dt>metrics: List of metrics to be evaluated by the model</dt>
<dd>during training and testing.
Typically you will use <cite>metrics=[&#8216;accuracy&#8217;]</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary,
such as <cite>metrics={&#8216;output_a&#8217;: &#8216;accuracy&#8217;}</cite>.</dd>
<dt>loss_weights: Optional list or dictionary specifying scalar</dt>
<dd>coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model&#8217;s outputs. If a tensor, it is expected to map
output names (strings) to scalar coefficients.</dd>
<dt>sample_weight_mode: If you need to do timestep-wise</dt>
<dd>sample weighting (2D weights), set this to <cite>&#8220;temporal&#8221;</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</dd>
<dt>weighted_metrics: List of metrics to be evaluated and weighted</dt>
<dd>by sample_weight or class_weight during training and testing.</dd>
<dt>target_tensors: By default, Keras will create placeholders for the</dt>
<dd>model&#8217;s target, which will be fed with the target data during
training. If instead you would like to use your own
target tensors (in turn, Keras will not expect external
Numpy data for these targets at training time), you
can specify them via the <cite>target_tensors</cite> argument. It can be
a single tensor (for a single-output model), a list of tensors,
or a dict mapping output names to target tensors.</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs: When using the Theano/CNTK backends, these arguments</dt>
<dd>are passed into K.function. When using the TensorFlow backend,
these arguments are passed into <cite>tf.Session.run</cite>.</dd>
</dl>
</dd>
<dt># Raises</dt>
<dd><dl class="first last docutils">
<dt>ValueError: In case of invalid arguments for</dt>
<dd><cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>dir_path</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.load_model">
<code class="descname">load_model</code><span class="sig-paren">(</span><em>path</em>, <em>custom_objects</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load weights and description of keras model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.predict_on_batch">
<code class="descname">predict_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.predict_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.predict_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get predictions on batch x.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dir_path</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_model.KerasModel.train_on_batch">
<code class="descname">train_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>y_true</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_model.html#KerasModel.train_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_model.KerasModel.train_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train model on batch.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.keras_resnet">
<span id="lung-cancer-models-keras-resnet-module"></span><h2>lung_cancer.models.keras_resnet module<a class="headerlink" href="#module-lung_cancer.models.keras_resnet" title="Permalink to this headline">¶</a></h2>
<p>Contains implementation of ResNet via keras.</p>
<dl class="class">
<dt id="lung_cancer.models.keras_resnet.KerasResNet50">
<em class="property">class </em><code class="descclassname">lung_cancer.models.keras_resnet.</code><code class="descname">KerasResNet50</code><span class="sig-paren">(</span><em>name</em>, <em>dropout_rate=0.3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_resnet.html#KerasResNet50"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_resnet.KerasResNet50" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.keras_model.KerasModel" title="lung_cancer.models.keras_model.KerasModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.keras_model.KerasModel</span></code></a></p>
<p>ResNet50 model for 3D scans implemented in keras.</p>
<dl class="method">
<dt id="lung_cancer.models.keras_resnet.KerasResNet50.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>dropout_rate=0.3</em>, <em>units=(256</em>, <em>64)</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_resnet.html#KerasResNet50.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_resnet.KerasResNet50.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build resnet50 model implemented in keras.</p>
<p>Args:
- input_tensor: keras Input layer;
- dropout_rate: float, dropout_rate for dense layers;</p>
<p>Returns:
- keras tensor of the last dense layer;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_resnet.KerasResNet50.conv_block">
<code class="descname">conv_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>kernel_size</em>, <em>filters</em>, <em>stage</em>, <em>block</em>, <em>strides=(2</em>, <em>2</em>, <em>2)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_resnet.html#KerasResNet50.conv_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_resnet.KerasResNet50.conv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>A block that has a conv layer at shortcut.</p>
<p>This layer consists of three 3D-convolutional layers with batch
normalization before &#8216;relu&#8217; activation. The output tesnor then
concatenated with result tensor of 3D-convolution applied to input tensor
of the block with (2, 2, 2)-strides.</p>
<p>Args:
- input_tensor: keras tensor, input tensor;
- kernel_size: tuple(int, int, int), size of the kernel along three dimensions
for all convolution operations in block.
- filters: tuple(int, int, int), number of filters in first, second and
third 3D-convolution operations;
- stage: int, number of stage, on par with block argument
used to derive names of inner layers;
- block: str, block prefix, on par with stage argument used
to derive names of inner layers;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_resnet.KerasResNet50.identity_block">
<code class="descname">identity_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>kernel_size</em>, <em>filters</em>, <em>stage</em>, <em>block</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_resnet.html#KerasResNet50.identity_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_resnet.KerasResNet50.identity_block" title="Permalink to this definition">¶</a></dt>
<dd><p>The identity block is the block that has no conv layer at shortcut.</p>
<p>This block consists of two convolutions with batch normalization before
&#8216;relu&#8217; activation. After three convolutions are applyed the ouput tensor
is concatenated with input tensor along filters dimension and go
through &#8216;relu&#8217; activation.</p>
<p>Args:
- input_tensor: keras tensor, input tensor;
- kernel_size: tuple(int, int, int), size of the kernel along three dimensions
for all convolution operations in block.
- filters: tuple(int, int, int), number of filters in first, second and
third 3D-convolution operations;
- stage: int, number of stage, on par with block argument
used to derive names of inner layers;
- block: str, block prefix, on par with stage argument used
to derive names of inner layers;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.keras_unet">
<span id="lung-cancer-models-keras-unet-module"></span><h2>lung_cancer.models.keras_unet module<a class="headerlink" href="#module-lung_cancer.models.keras_unet" title="Permalink to this headline">¶</a></h2>
<p>Contains KerasUnet model class.</p>
<dl class="class">
<dt id="lung_cancer.models.keras_unet.KerasUnet">
<em class="property">class </em><code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">KerasUnet</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#KerasUnet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.KerasUnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.keras_model.KerasModel" title="lung_cancer.models.keras_model.KerasModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.keras_model.KerasModel</span></code></a></p>
<p>KerasUnet model for 3D scans implemented in keras.</p>
<dl class="method">
<dt id="lung_cancer.models.keras_unet.KerasUnet.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#KerasUnet.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.KerasUnet.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build 3D unet model implemented in keras.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_unet.KerasUnet.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>optimizer</em>, <em>loss</em>, <em>metrics=None</em>, <em>loss_weights=None</em>, <em>sample_weight_mode=None</em>, <em>weighted_metrics=None</em>, <em>target_tensors=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lung_cancer.models.keras_unet.KerasUnet.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="docutils">
<dt># Arguments</dt>
<dd><dl class="first last docutils">
<dt>optimizer: String (name of optimizer) or optimizer object.</dt>
<dd>See [optimizers](/optimizers).</dd>
<dt>loss: String (name of objective function) or objective function.</dt>
<dd>See [losses](/losses).
If the model has multiple outputs, you can use a different loss
on each output by passing a dictionary or a list of losses.
The loss value that will be minimized by the model
will then be the sum of all individual losses.</dd>
<dt>metrics: List of metrics to be evaluated by the model</dt>
<dd>during training and testing.
Typically you will use <cite>metrics=[&#8216;accuracy&#8217;]</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary,
such as <cite>metrics={&#8216;output_a&#8217;: &#8216;accuracy&#8217;}</cite>.</dd>
<dt>loss_weights: Optional list or dictionary specifying scalar</dt>
<dd>coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model&#8217;s outputs. If a tensor, it is expected to map
output names (strings) to scalar coefficients.</dd>
<dt>sample_weight_mode: If you need to do timestep-wise</dt>
<dd>sample weighting (2D weights), set this to <cite>&#8220;temporal&#8221;</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</dd>
<dt>weighted_metrics: List of metrics to be evaluated and weighted</dt>
<dd>by sample_weight or class_weight during training and testing.</dd>
<dt>target_tensors: By default, Keras will create placeholders for the</dt>
<dd>model&#8217;s target, which will be fed with the target data during
training. If instead you would like to use your own
target tensors (in turn, Keras will not expect external
Numpy data for these targets at training time), you
can specify them via the <cite>target_tensors</cite> argument. It can be
a single tensor (for a single-output model), a list of tensors,
or a dict mapping output names to target tensors.</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: When using the Theano/CNTK backends, these arguments</dt>
<dd>are passed into K.function. When using the TensorFlow backend,
these arguments are passed into <cite>tf.Session.run</cite>.</dd>
</dl>
</dd>
<dt># Raises</dt>
<dd><dl class="first last docutils">
<dt>ValueError: In case of invalid arguments for</dt>
<dd><cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_unet.KerasUnet.reduction_block">
<code class="descname">reduction_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>scope</em>, <em>pool_size=(2</em>, <em>2</em>, <em>2)</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#KerasUnet.reduction_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.KerasUnet.reduction_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply reduction block transform to input tensor.</p>
<p>This layer consists of two 3D-convolutional layers with batch normalization
before &#8216;relu&#8217; activation and max_pooling3d layer in the end.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_unet.KerasUnet.upsampling_block">
<code class="descname">upsampling_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>scip_connect_tensor</em>, <em>filters</em>, <em>scope</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#KerasUnet.upsampling_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.KerasUnet.upsampling_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply upsampling transform to two input tensors.</p>
<p>First of all, UpSampling3D transform is applied to input_tensor. Then output
tensor of this operation is concatenated with scip_connect_tensor. After this
two 3D-convolutions with batch normalization before &#8216;relu&#8217; activation
are applied.</p>
<p>Args:
- input_tensor: keras tensor, input tensor from previous layer;
- scip_connect_tensor: keras tensor, input tensor from simmiliar
layer from reduction branch of UNet;
- filters: int, number of filters in convolutional layers;
- scope: str, name of scope for this block;
- padding: str, padding mode for convolutions, can be &#8216;same&#8217; or &#8216;valid&#8217;;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.dice_coef">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">dice_coef</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#dice_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.dice_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Dice coefficient required by keras model as a part of loss function.</p>
<p>Args:
- y_true: keras tensor with targets;
- y_pred: keras tensor with predictions;</p>
<p>Returns:
- keras tensor with dice coefficient value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.dice_coef_loss">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">dice_coef_loss</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#dice_coef_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.dice_coef_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Dice loss function.</p>
<p>Args:
- y_true: keras tensor containing target values;
- y_pred: keras tensor containing predicted values;</p>
<p>Returns:
- keras tensor containing dice loss;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.dice_coef_np">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">dice_coef_np</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>smooth=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#dice_coef_np"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.dice_coef_np" title="Permalink to this definition">¶</a></dt>
<dd><p>Dice coefficient for two input arrays.</p>
<p>Args:
- y_true: numpy array containing target values;
- y_pred: numpy array containing predicted values;</p>
<p>Returns:
- float, dice coefficient value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.jaccard_coef">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">jaccard_coef</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#jaccard_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.jaccard_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Jaccard coefficient.</p>
<p>Args:
- y_true: actual pixel-by-pixel values for all classes;
- y_pred: predicted pixel-by-pixel values for all classes;</p>
<p>Returns:
- jaccard score across all classes;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.jaccard_coef_logloss">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">jaccard_coef_logloss</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#jaccard_coef_logloss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.jaccard_coef_logloss" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras loss function based on jaccard coefficient.</p>
<p>Args:
- y_true: keras tensor containing target mask;
- y_pred: keras tensor containing predicted mask;</p>
<p>Returns:
- keras tensor with jaccard loss;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.tiversky_coef">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">tiversky_coef</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#tiversky_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.tiversky_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Tiversky coef.</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.keras_unet.tiversky_loss">
<code class="descclassname">lung_cancer.models.keras_unet.</code><code class="descname">tiversky_loss</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_unet.html#tiversky_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_unet.tiversky_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Tiversky loss function.</p>
<p>Args:
- y_true: keras tensor containing target mask;
- y_pred: keras tensor containing predicted mask;</p>
<p>Returns:
- keras tensor containing tiversky loss;</p>
</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.keras_vgg16">
<span id="lung-cancer-models-keras-vgg16-module"></span><h2>lung_cancer.models.keras_vgg16 module<a class="headerlink" href="#module-lung_cancer.models.keras_vgg16" title="Permalink to this headline">¶</a></h2>
<p>Contains implementation of VGG16 architecture in keras.</p>
<dl class="class">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16">
<em class="property">class </em><code class="descclassname">lung_cancer.models.keras_vgg16.</code><code class="descname">KerasVGG16</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_vgg16.html#KerasVGG16"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.keras_model.KerasModel" title="lung_cancer.models.keras_model.KerasModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.keras_model.KerasModel</span></code></a></p>
<p>KerasVGG16 model for 3D scans implemented in keras.</p>
<dl class="method">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>units=(512</em>, <em>256)</em>, <em>dropout_rate=0.35</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_vgg16.html#KerasVGG16.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build VGG16 model implemented in keras.</p>
<p>Args:
- units: tuple(int, int), number of units in first and second dense layers;
- dropout_rate: float, probability of dropout;</p>
<p>Returns:
- keras model;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16.classification_block">
<code class="descname">classification_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>units=(512</em>, <em>256)</em>, <em>dropout_rate=0.35</em>, <em>scope='ClassificationBlock'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_vgg16.html#KerasVGG16.classification_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16.classification_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Classification block of VGG16 architecture.</p>
<p>This block consists of flatten operation applied to input_tensor.
Then there is two fully connected layers with &#8216;relu&#8217; activation,
batch normalization and dropout layers. This block should be put
in the end of the model.</p>
<p>Args:
- input_tensor: keras tensor, input tensor;
- units: tuple(int, int), number of units in first and second dense layers;
- dropoout_rate: float, probability of dropout;
- scope: str, name of scope;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>optimizer</em>, <em>loss</em>, <em>metrics=None</em>, <em>loss_weights=None</em>, <em>sample_weight_mode=None</em>, <em>weighted_metrics=None</em>, <em>target_tensors=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="docutils">
<dt># Arguments</dt>
<dd><dl class="first last docutils">
<dt>optimizer: String (name of optimizer) or optimizer object.</dt>
<dd>See [optimizers](/optimizers).</dd>
<dt>loss: String (name of objective function) or objective function.</dt>
<dd>See [losses](/losses).
If the model has multiple outputs, you can use a different loss
on each output by passing a dictionary or a list of losses.
The loss value that will be minimized by the model
will then be the sum of all individual losses.</dd>
<dt>metrics: List of metrics to be evaluated by the model</dt>
<dd>during training and testing.
Typically you will use <cite>metrics=[&#8216;accuracy&#8217;]</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary,
such as <cite>metrics={&#8216;output_a&#8217;: &#8216;accuracy&#8217;}</cite>.</dd>
<dt>loss_weights: Optional list or dictionary specifying scalar</dt>
<dd>coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model&#8217;s outputs. If a tensor, it is expected to map
output names (strings) to scalar coefficients.</dd>
<dt>sample_weight_mode: If you need to do timestep-wise</dt>
<dd>sample weighting (2D weights), set this to <cite>&#8220;temporal&#8221;</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</dd>
<dt>weighted_metrics: List of metrics to be evaluated and weighted</dt>
<dd>by sample_weight or class_weight during training and testing.</dd>
<dt>target_tensors: By default, Keras will create placeholders for the</dt>
<dd>model&#8217;s target, which will be fed with the target data during
training. If instead you would like to use your own
target tensors (in turn, Keras will not expect external
Numpy data for these targets at training time), you
can specify them via the <cite>target_tensors</cite> argument. It can be
a single tensor (for a single-output model), a list of tensors,
or a dict mapping output names to target tensors.</dd>
<dt><a href="#id5"><span class="problematic" id="id6">**</span></a>kwargs: When using the Theano/CNTK backends, these arguments</dt>
<dd>are passed into K.function. When using the TensorFlow backend,
these arguments are passed into <cite>tf.Session.run</cite>.</dd>
</dl>
</dd>
<dt># Raises</dt>
<dd><dl class="first last docutils">
<dt>ValueError: In case of invalid arguments for</dt>
<dd><cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16.reduction_block_I">
<code class="descname">reduction_block_I</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>scope</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_vgg16.html#KerasVGG16.reduction_block_I"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16.reduction_block_I" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction block of type I for VGG16 architecture.</p>
<p>Applyes 3D-convolution with kernel size (3, 3, 3), (1, 1, 1) strides
and &#8216;relu&#8217; activation, after performs batch noramlization, then
again 3D-convolution with kernel size (3, 3, 3),
strides (1, 1, 1) and &#8216;relu&#8217; activation,  that batch normalization;
After all applyes 3D maxpooling operation with strides (2, 2, 2)
and pooling size (2, 2, 2).</p>
<p>Args:
- input_tensor: keras tensor, input tensor;
- filters: int, number of filters in 3D-convolutional layers;
- scope: str, name of the scope;
- padding: str, padding mode can be &#8216;same&#8217; or &#8216;valid&#8217;;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.keras_vgg16.KerasVGG16.reduction_block_II">
<code class="descname">reduction_block_II</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>scope</em>, <em>padding='same'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/keras_vgg16.html#KerasVGG16.reduction_block_II"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.keras_vgg16.KerasVGG16.reduction_block_II" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduction block of type II for VGG16 architecture.</p>
<p>Applyes 3D-convolution with kernel size (3, 3, 3), strides (1, 1, 1)
and &#8216;relu&#8217; activation, after that preform batch noramlization,
repeates this combo three times;
Finally, adds 3D maxpooling layer with
strides (2, 2, 2) and pooling size (2, 2, 2).</p>
<p>Args:
- input_tensor: keras tensor, input tensor;
- filters: int, number of filters in 3D-convolutional layers;
- scope: str, name of the scope;
- padding: str, padding mode can be &#8216;same&#8217; or &#8216;valid&#8217;;</p>
<p>Returns:
- output tensor, keras tensor;</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.layers">
<span id="lung-cancer-models-layers-module"></span><h2>lung_cancer.models.layers module<a class="headerlink" href="#module-lung_cancer.models.layers" title="Permalink to this headline">¶</a></h2>
<p>Helper functions for creating layers</p>
<dl class="function">
<dt id="lung_cancer.models.layers.conv3d_bnorm_activation">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">conv3d_bnorm_activation</code><span class="sig-paren">(</span><em>inputs</em>, <em>training</em>, <em>add_bnorm=True</em>, <em>activation=&lt;function relu&gt;</em>, <em>kernel=(7</em>, <em>7</em>, <em>7)</em>, <em>channels=1</em>, <em>initializer='xavier'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#conv3d_bnorm_activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.conv3d_bnorm_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>form conv3d -&gt; batch norm -&gt; relu
:param inputs: input layer, 5d-tensor: (None, depth, width, height, input_channels)
:param training: boolean tf placeholder; if True then bnorm is used in training mode
:param add_bnorm: whether Batch-norm should be added after convolution
:param activation: nonlinearity to use after bnorm
:param kernel: conv3d filter size
:param channels: number of channels in image after conv
:param initializer: initializer to use for weights initialization</p>
<blockquote>
<div>can be &#8216;xavier&#8217; or &#8216;normal&#8217;</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None, depth, width, height, channels)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">output, 5d-tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.layers.deconv3d_bnorm_activation">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">deconv3d_bnorm_activation</code><span class="sig-paren">(</span><em>inputs</em>, <em>training</em>, <em>add_bnorm=True</em>, <em>activation=&lt;function relu&gt;</em>, <em>kernel=(5</em>, <em>5</em>, <em>5)</em>, <em>channels=1</em>, <em>initializer='xavier'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#deconv3d_bnorm_activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.deconv3d_bnorm_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>form upsampling deconv3d -&gt; batch norm -&gt; relu</p>
<dl class="docutils">
<dt><a href="#id7"><span class="problematic" id="id8">*</span></a>Note: this is doubling deconv-layer</dt>
<dd>that is, the stride is always 2 in all spatial dims</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> &#8211; input layer, 5d-tensor: (None, depth, width, height, input_channels)</li>
<li><strong>training</strong> &#8211; boolean tf placeholder; if True then bnorm is used in training mode</li>
<li><strong>add_bnorm</strong> &#8211; whether Batch-norm should be added after deconvolution</li>
<li><strong>activation</strong> &#8211; nonlinearity to use after bnorm</li>
<li><strong>kernel</strong> &#8211; deconv3d filter size</li>
<li><strong>channels</strong> &#8211; number of channels in image after deconv</li>
<li><strong>initializer</strong> &#8211; initializer to use for weights initialization
can be &#8216;xavier&#8217; or &#8216;normal&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(None, 2 * depth, 2 * width, 2 * height, channels)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output, 5d-tensor</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.layers.selu">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">selu</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#selu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.selu" title="Permalink to this definition">¶</a></dt>
<dd><p>selu activation function
:param input tensor x:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">selu(x)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.layers.tf_dice_loss">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">tf_dice_loss</code><span class="sig-paren">(</span><em>scope</em>, <em>masks_prediction</em>, <em>masks_ground_truth</em>, <em>epsilon=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#tf_dice_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.tf_dice_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Form loss = - dice given predicions for masks and true masks. Resulting</dt>
<dd>loss is given by tf-tensor.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scope</strong> &#8211; scope to create loss-op</li>
<li><strong>masks_prediction</strong> &#8211; normalized to [0, 1] 5d-tensor output
of a net (one dim is fake)</li>
<li><strong>masks_ground_truth</strong> &#8211; true cancer-masks, 5d-placeholder with
last fake dim</li>
<li><strong>epsilon</strong> &#8211; add small epsilon to the denominator if problems with
division on zero arise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>zero-shape tf tensor = mean(dice loss) across batch of scans;</dt>
<dd><p class="first last">name = &#8216;scope/loss&#8217;</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.layers.vnet_down">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">vnet_down</code><span class="sig-paren">(</span><em>scope</em>, <em>net_down</em>, <em>training</em>, <em>pool_size=(2</em>, <em>2</em>, <em>2)</em>, <em>strides=(2</em>, <em>2</em>, <em>2)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#vnet_down"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.vnet_down" title="Permalink to this definition">¶</a></dt>
<dd><p>form downsampling vnet layer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scope</strong> &#8211; scope to create ops in</li>
<li><strong>net_down</strong> &#8211; layer from the left (downsampling) part of v-net</li>
<li><strong>training</strong> &#8211; boolean tf placeholder; if True then bnorm is used in training mode</li>
<li><strong>pool_size</strong> &#8211; window for downsampling max-pooling</li>
<li><strong>strides</strong> &#8211; max_pooling strides</li>
<li><strong>add_bnorm</strong> &#8211; whether Batch-norm should be added after deconvolution</li>
<li><strong>activation</strong> &#8211; nonlinearity to use after bnorm</li>
<li><strong>kernel</strong> &#8211; filter size of convolution</li>
<li><strong>channels</strong> &#8211; number of channels in output layer, typically = 2 x channels in
net_down</li>
<li><strong>initializer</strong> &#8211; initializer to use for weights initialization
can be &#8216;xavier&#8217; or &#8216;normal&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">5d-tensor; shape[4] = channels; with name = &#8216;scope/output&#8217;</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output layer</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Schematically:</dt>
<dd><p class="first">net_down -&gt; conv -&gt; max pooling
&#8212;-                         &#8212;-</p>
<blockquote class="last">
<div><p>output
&#8212;&#8212;&#8211;               &#8212;&#8212;&#8211;</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8212;&#8212;&#8212;&#8212; ... &#8212;&#8212;&#8212;&#8212;</dt>
<dd>...</dd>
</dl>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.layers.vnet_up">
<code class="descclassname">lung_cancer.models.layers.</code><code class="descname">vnet_up</code><span class="sig-paren">(</span><em>scope</em>, <em>net_up</em>, <em>net_down</em>, <em>training</em>, <em>add_bnorm=True</em>, <em>activation=&lt;function relu&gt;</em>, <em>kernel=(3</em>, <em>3</em>, <em>3)</em>, <em>channels=1</em>, <em>initializer='xavier'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/layers.html#vnet_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.layers.vnet_up" title="Permalink to this definition">¶</a></dt>
<dd><p>form upsampling vnet layer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scope</strong> &#8211; scope to create ops in</li>
<li><strong>net_up</strong> &#8211; layer from the right (upsampling) part of v-net,
5d-tensor of shape (None, depth, width, height, input_channels)</li>
<li><strong>net_down</strong> &#8211; layer from the left (downsampling) part of v-net
should shape = net_up.shape</li>
<li><strong>training</strong> &#8211; boolean tf placeholder; if True then bnorm is used in training mode</li>
<li><strong>add_bnorm</strong> &#8211; whether Batch-norm should be added after deconvolution</li>
<li><strong>activation</strong> &#8211; nonlinearity to use after bnorm</li>
<li><strong>kernel</strong> &#8211; filter size of deconvolution</li>
<li><strong>channels</strong> &#8211; number of channels in output layer, typically = 1/2 x channels in
net_down</li>
<li><strong>initializer</strong> &#8211; initializer to use for weights initialization
can be &#8216;xavier&#8217; or &#8216;normal&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>5d-tensor, shape[4] = channels; with name = &#8216;scope/output&#8217;</p>
<p>Schematically:</p>
<blockquote>
<div><blockquote>
<div><p>output</p>
</div></blockquote>
<dl class="docutils">
<dt>&#8212;-                         &#8212;-</dt>
<dd><p class="first">net_down               net_up   deconv(net_down &amp; net_up) /|                     &#8212;&#8212;&#8211;    concat     &#8212;&#8212;&#8211;
&#8212;&#8212;&#8212;&#8212; ... &#8212;&#8212;&#8212;&#8212;</p>
<blockquote class="last">
<div><p>...</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.metrics">
<span id="lung-cancer-models-metrics-module"></span><h2>lung_cancer.models.metrics module<a class="headerlink" href="#module-lung_cancer.models.metrics" title="Permalink to this headline">¶</a></h2>
<p>Contain different metrics functions.</p>
<dl class="function">
<dt id="lung_cancer.models.metrics.accuracy">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">accuracy</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute accuracy on input batched y_pred and y_true.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;</p>
<p>Returns:
- float, accuracy metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.dice">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">dice</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#dice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.dice" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Dice coefficient.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.fn">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">fn</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of False Negative values.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;</p>
<p>Returns:
- float, number of false negative predictions;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.fnr">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">fnr</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#fnr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.fnr" title="Permalink to this definition">¶</a></dt>
<dd><p>False negative rate.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, fnr metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.fp">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">fp</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#fp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.fp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of False Positive values.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;</p>
<p>Returns:
- float, number of false positive predictions;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.fpr">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">fpr</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#fpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.fpr" title="Permalink to this definition">¶</a></dt>
<dd><p>False positive rate.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, fpr metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.log_loss">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">log_loss</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#log_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.log_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log-loss.</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.mae">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">mae</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#mae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MAE metric.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.mse">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">mse</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#mse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.mse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MSE metric.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.precision">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">precision</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute precision metric.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, precision metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.recall">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">recall</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute recall metric.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, recall metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.rmse">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">rmse</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#rmse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.rmse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RMSE metric.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.sym_dice">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">sym_dice</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>alpha</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#sym_dice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.sym_dice" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetric dice coefficient.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.tn">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">tn</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#tn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.tn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of True Negative values.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;</p>
<p>Returns:
- float, number of true negative predictions;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.tnr">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">tnr</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#tnr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.tnr" title="Permalink to this definition">¶</a></dt>
<dd><p>True negative rate.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, tnr metric value;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.tp">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">tp</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#tp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.tp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of True Positive values.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;</p>
<p>Returns:
- float, number of true positive predictions;</p>
</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.metrics.tpr">
<code class="descclassname">lung_cancer.models.metrics.</code><code class="descname">tpr</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>threshold=0.5</em>, <em>epsilon=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/metrics.html#tpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.metrics.tpr" title="Permalink to this definition">¶</a></dt>
<dd><p>True positive rate.</p>
<p>Args:
- y_pred: np.ndarray(batch_size, ...)
numpy array containing predictions of model;
- y_true: np.ndarray(batch_size, ...)
numpy array containing true target values;
- threshold: float, threshold for mapping probabilities into class;
- epsilon: small float for avoiding division by zero error;</p>
<p>Returns:
- float, tpr metric value;</p>
</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.models_batch">
<span id="lung-cancer-models-models-batch-module"></span><h2>lung_cancer.models.models_batch module<a class="headerlink" href="#module-lung_cancer.models.models_batch" title="Permalink to this headline">¶</a></h2>
<p>Child class of CTImagesBatch that incorporates nn-models</p>
<dl class="class">
<dt id="lung_cancer.models.models_batch.CTImagesModels">
<em class="property">class </em><code class="descclassname">lung_cancer.models.models_batch.</code><code class="descname">CTImagesModels</code><span class="sig-paren">(</span><em>index</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/models_batch.html#CTImagesModels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.models_batch.CTImagesModels" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lung_cancer.preprocessing.html#lung_cancer.preprocessing.ct_masked_batch.CTImagesMaskedBatch" title="lung_cancer.preprocessing.ct_masked_batch.CTImagesMaskedBatch"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.preprocessing.ct_masked_batch.CTImagesMaskedBatch</span></code></a></p>
<dl class="docutils">
<dt>Сlass for describing, training nn-models of segmentation/classification;</dt>
<dd>inference using models is also supported.</dd>
</dl>
<dl class="method">
<dt>
<code class="descname">1. selu_vnet_4</code></dt>
<dd><p>build vnet of depth = 4 using tensorflow,
return tensors necessary for training, evaluating and inferencing</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">2. train_vnet_4</code></dt>
<dd><p>train selu_vnet_4 on images and masks, that are contained in batch</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">3. update_test_stats</code></dt>
<dd><p>method for evaluation of the model on test-batch (test-dataset) during
training</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">4. get_cancer_segmentation</code></dt>
<dd><p>method for performing inference on images of batch using trained model</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.models_batch.CTImagesModels.keras_unet">
<code class="descname">keras_unet</code><span class="sig-paren">(</span><em>pipeline</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/models_batch.html#CTImagesModels.keras_unet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.models_batch.CTImagesModels.keras_unet" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Unet model implemented in keras and immediatelly compile it.</p>
<p>This method is wrapped with model(mode=&#8217;static&#8217;) decorator meaning
that model is created in the momment when pipeline.run(...) is called.
Config attribute is a dictionary that can contain &#8216;loss&#8217; and &#8216;path&#8217;
values. If config contains &#8216;path&#8217;, then model is loaded from directory
specified by this parameter. Otherwise new keras model is to be built;</p>
<p>Another key of config dict is &#8216;loss&#8217;. Value &#8216;loss&#8217; can be one of
two str: &#8216;dice&#8217; or &#8216;tiversky&#8217;. This value specifies the loss function
that will be used during model compilation;</p>
<p>Args:
- pipeline: Pipeline object from dataset package; it is the only argument
and it is used to pass parameters required by model being created
through pipeline.config attribute;</p>
<p>Returns:
- compiled model;</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.tf_model">
<span id="lung-cancer-models-tf-model-module"></span><h2>lung_cancer.models.tf_model module<a class="headerlink" href="#module-lung_cancer.models.tf_model" title="Permalink to this headline">¶</a></h2>
<p>Contains base class for all tensorflow models.</p>
<dl class="class">
<dt id="lung_cancer.models.tf_model.TFModel">
<em class="property">class </em><code class="descclassname">lung_cancer.models.tf_model.</code><code class="descname">TFModel</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.base_model.BaseModel" title="lung_cancer.models.base_model.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.base_model.BaseModel</span></code></a></p>
<p>Base class for all tensorflow models.</p>
<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.add_restore_op">
<code class="descname">add_restore_op</code><span class="sig-paren">(</span><em>operation</em>, <em>alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.add_restore_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.add_restore_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable tf.Operation to be restored after dump as an attribute.</p>
<p>Args:
- operation: tf.Operation, operation to add to collection of operations
that can be restored after dump;
- alias: str, alias for tf.Operation which will be used as a name of
attribute for accessing this operation;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.add_restore_var">
<code class="descname">add_restore_var</code><span class="sig-paren">(</span><em>variable</em>, <em>alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.add_restore_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.add_restore_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable tf.Tensor or tf.Variable to be restored after dump as an attribute.</p>
<p>Args:
- variable: tf.Tensor or tf.Variable to add to collection of variables
that can be restored after dump;
- alias: str, alias for tf.Variable or tf.Tensor which will be used as
a name of attribute for accessing it from outside of TFModel instance;</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lung_cancer.models.tf_model.TFModel.batch_size">
<em class="property">static </em><code class="descname">batch_size</code><span class="sig-paren">(</span><em>input_tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.batch_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return batch size of the input tensor represented by first dimension.</p>
<p>Args:
- input_tensor: tf.Variable, input_tensor.</p>
<p>Return:
- number of items in the batch, int;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.bn_conv3d">
<code class="descname">bn_conv3d</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>kernel_size</em>, <em>name</em>, <em>strides=(1</em>, <em>1</em>, <em>1)</em>, <em>padding='same'</em>, <em>activation=&lt;function relu&gt;</em>, <em>use_bias=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.bn_conv3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.bn_conv3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply 3D convolution operation with batch normalization to input tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- filters: int, number of filters in the ouput tensor;
- kernel_size: tuple(int, int, int), size of kernel</p>
<blockquote>
<div>of 3D convolution operation along 3 dimensions;</div></blockquote>
<ul class="simple">
<li>name: str, name of the layer that will be used as an argument of tf.variable_scope;</li>
<li>strides: tuple(int, int, int), size of strides along 3 dimensions;</li>
<li>padding: str, padding mode, can be &#8216;same&#8217; or &#8216;valid&#8217;;</li>
<li>activation: tensorflow activation function that will be applied to</li>
</ul>
<p>output tensor;
- use_bias: bool, whether use bias or not;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build tensorflow model.</p>
<p>This method must be implemented in ancestor class:
inside it tensorflow model must be build,
self.y_true, self.input, self.y_pred, self.loss attributes
must be set as tensorflow tensors;</p>
<p>NOTE: this method will be automatically called when compile method
is called by user;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>optimizer</em>, <em>loss</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.compile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile tensorflow model.</p>
<p>First of all compile method enters in the context of graph that
corresponds to the model. After that it calls build_model method.
Finally, it assigns loss tensor(loss_tensor = loss(self.y_true, self.y_pred))
to self.loss attribute and assigns result of optimizer.minimize(self.loss)
operation to self.train_step attribute.</p>
<p>NOTE: after assignment self.loss and self.train_step are added to
collections of restorable tensors and operations.</p>
<p>Args:
- optimizer: optimizer from tf.train.*;
- loss: tensorflow function that takes self.y_true as its first argument
self.y_pred as its second argument and return real-value tensor as result.</p>
<p>NOTE: it&#8217;s strongly recommended to create optimizer and pass it into compile method
inside model context(see Example)</p>
<p>Example:
&gt;&gt;&gt; tf_model = TFResNetModel(&#8216;resnet50&#8217;)
&gt;&gt;&gt; with tf_model:
...     tf_model.compile(optimizer=tf.train.AdamOptimizer(0.005), loss=tf.losses.log_loss)</p>
<p>that is equal to</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tf_model</span> <span class="o">=</span> <span class="n">TFResNetModel</span><span class="p">(</span><span class="s1">&#39;resnet50&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">tf_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="mf">0.005</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">log_loss</span><span class="p">)</span>
</pre></div>
</div>
<p>but is shorter.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.conv3d">
<code class="descname">conv3d</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>filters</em>, <em>kernel_size</em>, <em>name</em>, <em>strides=(1</em>, <em>1</em>, <em>1)</em>, <em>padding='same'</em>, <em>activation=&lt;function relu&gt;</em>, <em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.conv3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.conv3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply 3D convolution operation to input tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- filters: int, number of filters in the ouput tensor;
- kernel_size: tuple(int, int, int), size of kernel</p>
<blockquote>
<div>of 3D convolution operation along 3 dimensions;</div></blockquote>
<ul class="simple">
<li>name: str, name of the layer that will be used as an argument of tf.variable_scope;</li>
<li>strides: tuple(int, int, int), size of strides along 3 dimensions;</li>
<li>padding: str, padding mode, can be &#8216;same&#8217; or &#8216;valid&#8217;;</li>
<li>activation: tensorflow activation function that will be applied to</li>
</ul>
<p>output tensor;
- use_bias: bool, whether use bias or not;</p>
<p>Returns:
- tf.Variable, output tensor;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.get_number_of_trainable_vars">
<code class="descname">get_number_of_trainable_vars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.get_number_of_trainable_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.get_number_of_trainable_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of trainable variable in graph associated with current model.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lung_cancer.models.tf_model.TFModel.get_shape">
<em class="property">static </em><code class="descname">get_shape</code><span class="sig-paren">(</span><em>input_tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.get_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.get_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return full shape of the input tensor represented by tuple of ints.</p>
<p>Args:
- input_tensor: tf.Variable, input_tensor;</p>
<p>Return:
- shape of input_tensor, tuple(int);</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>dir_path</em>, <em>graph_path</em>, <em>checkpoint=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load tensorflow model.</p>
<p>Args:
- dir_path: str, path to directory on hard drive where model
was saved via save method;
- graph_path: str, path to file with metagraph;
- checkpoint: str or None, if str then must represent path
to checkpoint file that will be loaded, if None then latest checkpoint
from &#8216;dir_path&#8217; directory will be loaded;</p>
<p>Example:
&gt;&gt;&gt; tf_model = TFResNetModel(&#8216;resnet50&#8217;)
&gt;&gt;&gt; tf.model.load(&#8216;/path/to/resnet50/model/&#8217;, &#8216;/path/to/resnet50/model/resnet50-1982.meta&#8217;)</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lung_cancer.models.tf_model.TFModel.num_channels">
<em class="property">static </em><code class="descname">num_channels</code><span class="sig-paren">(</span><em>input_tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.num_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.num_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return channels dimension of the input tensor.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor.</p>
<p>Return:
- number of channels, int;</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.predict_on_batch">
<code class="descname">predict_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.predict_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.predict_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get prediction of tensorflow model on batch data.</p>
<p>Args:
- x: ndarray, numpy array that will be fed to input
placeholder(self.input attribute by default);</p>
<p>Returns:
- y_pred: ndarray containing predictions of the model;</p>
<p>NOTE: <a href="#id9"><span class="problematic" id="id10">**</span></a>kwargs argument is added for compatibillity
with BaseModel method.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dir_path</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save tensorflow model.</p>
<p>Args:
- dir_path: str, path to directory on hard drive that will be used
for storing model&#8217;s data;</p>
<p>Returns:
- self, TFModel instance;</p>
<p>NOTE: <a href="#id11"><span class="problematic" id="id12">*</span></a>args and <a href="#id13"><span class="problematic" id="id14">**</span></a>kwargs are added for compatibillity with BaseModel class.</p>
<p>Example:
&gt;&gt;&gt; tf_model = TFResNetModel(&#8216;resnet50&#8217;)
&gt;&gt;&gt; .............training model..............
&gt;&gt;&gt; tf_model.save(&#8216;/path/to/resnet50/model/&#8217;)</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.set_decay">
<code class="descname">set_decay</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.set_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.set_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Set decay of learning rate.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_model.TFModel.train_on_batch">
<code class="descname">train_on_batch</code><span class="sig-paren">(</span><em>x</em>, <em>y_true</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#TFModel.train_on_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.TFModel.train_on_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train tensorflow model on batch data.</p>
<p>Args:
- x: ndarray, numpy array that will be fed into input
placeholder(self.input attribute by default);
- y_true: ndarray, numpy array that will be fed into
&#8216;true-value&#8217; placeholder(self.y_true attribute by default);</p>
<p>Returns:
- None;</p>
<p>NOTE: <a href="#id15"><span class="problematic" id="id16">**</span></a>kwargs argument is added for compatibillity
with BaseModel method.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lung_cancer.models.tf_model.restore_nodes">
<code class="descclassname">lung_cancer.models.tf_model.</code><code class="descname">restore_nodes</code><span class="sig-paren">(</span><em>*names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_model.html#restore_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_model.restore_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for making output tensors of TFModel method be restorable as attributes.</p>
</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models.tf_resnet">
<span id="lung-cancer-models-tf-resnet-module"></span><h2>lung_cancer.models.tf_resnet module<a class="headerlink" href="#module-lung_cancer.models.tf_resnet" title="Permalink to this headline">¶</a></h2>
<p>Contains TFResNet model class.</p>
<dl class="class">
<dt id="lung_cancer.models.tf_resnet.TFResNet">
<em class="property">class </em><code class="descclassname">lung_cancer.models.tf_resnet.</code><code class="descname">TFResNet</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_resnet.html#TFResNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_resnet.TFResNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lung_cancer.models.tf_model.TFModel" title="lung_cancer.models.tf_model.TFModel"><code class="xref py py-class docutils literal"><span class="pre">lung_cancer.models.tf_model.TFModel</span></code></a></p>
<p>This class implements 3D ResNet architecture via tensorflow.</p>
<dl class="method">
<dt id="lung_cancer.models.tf_resnet.TFResNet.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_resnet.html#TFResNet.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_resnet.TFResNet.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build renset model implemented via tensorflow.</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_resnet.TFResNet.conv_block">
<code class="descname">conv_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>kernel_size</em>, <em>filters</em>, <em>name</em>, <em>strides=(2</em>, <em>2</em>, <em>2)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_resnet.html#TFResNet.conv_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_resnet.TFResNet.conv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolutional block that has a conv layer as shortcut.</p>
<p>Args:
- input_tensor: tf.Variable, input tensor;
- kernel_size: tuple(int, int, int), size of kernel
of 3D convolution along 3 dimension of the middle layer;
- filetrs: tuple(int, int, int)</p>
</dd></dl>

<dl class="method">
<dt id="lung_cancer.models.tf_resnet.TFResNet.identity_block">
<code class="descname">identity_block</code><span class="sig-paren">(</span><em>input_tensor</em>, <em>kernel_size</em>, <em>filters</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lung_cancer/models/tf_resnet.html#TFResNet.identity_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lung_cancer.models.tf_resnet.TFResNet.identity_block" title="Permalink to this definition">¶</a></dt>
<dd><p>The identity block is the block that has no conv layer at shortcut.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lung_cancer.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lung_cancer.models" title="Permalink to this headline">¶</a></h2>
<p>Module of nn-models for classification/segmentation of
lung-cancer on CT-scans</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Models module</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.base_model">lung_cancer.models.base_model module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.dense_net">lung_cancer.models.dense_net module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.keras_model">lung_cancer.models.keras_model module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.keras_resnet">lung_cancer.models.keras_resnet module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.keras_unet">lung_cancer.models.keras_unet module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.keras_vgg16">lung_cancer.models.keras_vgg16 module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.layers">lung_cancer.models.layers module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.metrics">lung_cancer.models.metrics module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.models_batch">lung_cancer.models.models_batch module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.tf_model">lung_cancer.models.tf_model module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models.tf_resnet">lung_cancer.models.tf_resnet module</a></li>
<li><a class="reference internal" href="#module-lung_cancer.models">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lung_cancer.preprocessing.html"
                        title="previous chapter">Preprocessing module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/lung_cancer.models.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lung_cancer.preprocessing.html" title="Preprocessing module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">RadIO 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, analysiscenter.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>